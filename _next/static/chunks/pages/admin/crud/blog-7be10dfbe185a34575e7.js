_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[18],{MUZa:function(e,t,c){"use strict";c.r(t);var r=c("nKUr"),s=c("5Yp1"),n=c("vC6e"),a=c("z7pX"),l=c("cpVT"),o=(c("YFqc"),c("q1tI")),i=c("nOHt"),j=c.n(i),b=c("a6RD"),u=c.n(b),d=c("iuBY"),O=c("abxw"),h=c("SMr6"),m=c("zycw"),f=(c("91UR"),c("//g3"));c("qsEy");function p(e,t){var c=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),c.push.apply(c,r)}return c}function x(e){for(var t=1;t<arguments.length;t++){var c=null!=arguments[t]?arguments[t]:{};t%2?p(Object(c),!0).forEach((function(t){Object(l.a)(e,t,c[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(c)):p(Object(c)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(c,t))}))}return e}var g=u()((function(){return Promise.all([c.e(0),c.e(10),c.e(11)]).then(c.t.bind(null,"rmP6",7))}),{ssr:!1,loadableGenerated:{webpack:function(){return["rmP6"]},modules:["react-quill"]}}),v=Object(i.withRouter)((function(e){var t=e.router,c=Object(o.useState)([]),s=c[0],n=c[1],i=Object(o.useState)([]),b=i[0],u=i[1],p=Object(o.useState)([]),v=p[0],N=p[1],y=Object(o.useState)([]),w=y[0],S=y[1],P=Object(o.useState)(!!localStorage.getItem("blog")&&JSON.parse(localStorage.getItem("blog"))),_=P[0],E=P[1],D=Object(o.useState)({error:"",sizeError:"",success:"",formData:"",title:"",hidePublishButton:!1}),k=D[0],C=D[1],z=k.error,B=(k.sizeError,k.success),I=k.formData,T=k.title,Z=(k.hidePublishButton,Object(d.b)("token"));Object(o.useEffect)((function(){C(x(x({},k),{},{formData:new FormData})),M(),U()}),[t]);var M=function(){Object(O.b)().then((function(e){e.error?C(x(x({},k),{},{error:e.error})):n(e)}))},U=function(){Object(h.b)().then((function(e){e.error?C(x(x({},k),{},{error:e.error})):u(e)}))},Y=function(e){e.preventDefault(),Object(m.a)(I,Z).then((function(e){e.error?C(x(x({},k),{},{error:e.error})):(C(x(x({},k),{},{title:"",error:"",success:'The Blog "'.concat(e.title,'" is created')})),E(""),n([]),u([]),Object(d.c)()&&1===Object(d.c)().role?j.a.replace("/admin"):Object(d.c)()&&0===Object(d.c)().role&&j.a.replace("/user"))}))},q=function(e){return function(t){var c;console.log(t.target.value);var r="photo"===e?t.target.files[0]:t.target.value;I.set(e,r),C(x(x({},k),{},(c={},Object(l.a)(c,e,r),Object(l.a)(c,"formData",I),Object(l.a)(c,"error",""),c)))}},J=function(e){E(e),I.set("body",e),localStorage.setItem("blog",JSON.stringify(e))},F=function(e){return function(){C(x(x({},k),{},{error:""}));var t=v.indexOf(e),c=Object(a.a)(v);-1===t?c.push(e):c.splice(t,1),console.log(c),N(c),I.set("categories",c)}},H=function(e){return function(){C(x(x({},k),{},{error:""}));var t=w.indexOf(e),c=Object(a.a)(w);-1===t?c.push(e):c.splice(t,1),console.log(c),S(c),I.set("tags",c)}};return Object(r.jsx)("div",{className:"container-fluid pb-5",children:Object(r.jsxs)("div",{className:"row",children:[Object(r.jsxs)("div",{className:"col-md-8",children:[Object(r.jsxs)("form",{onSubmit:Y,children:[Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{className:"class-muted",children:"Title"}),Object(r.jsx)("input",{className:"form-control",value:T,type:"text",onChange:q("title")})]}),Object(r.jsx)("div",{className:"form-group",children:Object(r.jsx)(g,{modules:f.b,formats:f.a,value:_,placeholder:"Write something amazing",onChange:J})}),Object(r.jsx)("div",{children:Object(r.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Publish"})})]}),Object(r.jsxs)("div",{className:"pt-3",children:[Object(r.jsx)("div",{className:"alert alert-danger",style:{display:z?"":"none"},children:z}),Object(r.jsx)("div",{className:"alert alert-success",style:{display:B?"":"none"},children:B})]})]}),Object(r.jsxs)("div",{className:"col-md-4",children:[Object(r.jsx)("div",{children:Object(r.jsxs)("div",{className:"form-group pb-2",children:[Object(r.jsx)("h5",{children:"Featured image"}),Object(r.jsx)("hr",{}),Object(r.jsx)("small",{className:"text-muted",children:"Max size: 1MB"}),Object(r.jsx)("br",{}),Object(r.jsxs)("label",{className:"btn btn-outline-info",children:["Upload featured image",Object(r.jsx)("input",{onChange:q("photo"),type:"file",accept:"image/*",hidden:!0})]})]})}),Object(r.jsxs)("div",{children:[Object(r.jsx)("h5",{children:"Categories"}),Object(r.jsx)("hr",{}),Object(r.jsx)("ul",{style:{maxHeight:"200px",overflowY:"scroll"},children:s&&s.map((function(e,t){return Object(r.jsxs)("li",{className:"list-unstyled",children:[Object(r.jsx)("input",{onChange:F(e._id),type:"checkbox",className:"mr-2"}),Object(r.jsx)("label",{className:"form-check-label",children:e.name})]},t)}))})]}),Object(r.jsxs)("div",{children:[Object(r.jsx)("h5",{children:"Tags"}),Object(r.jsx)("hr",{}),Object(r.jsx)("ul",{style:{maxHeight:"200px",overflowY:"scroll"},children:b&&b.map((function(e,t){return Object(r.jsxs)("li",{className:"list-unstyled",children:[Object(r.jsx)("input",{onChange:H(e._id),type:"checkbox",className:"mr-2"}),Object(r.jsx)("label",{className:"form-check-label",children:e.name})]},t)}))})]})]})]})})}));t.default=function(){return Object(o.useEffect)((function(){void 0===localStorage.getItem("executed")&&(window.location.reload(),localStorage.setItem("executed",!0))}),[]),Object(r.jsx)(s.a,{children:Object(r.jsx)(n.a,{children:Object(r.jsx)("div",{className:"container-fluid",children:Object(r.jsxs)("div",{className:"row",children:[Object(r.jsx)("div",{className:"col-md-12 pt-5 pb-5",children:Object(r.jsx)("h2",{children:"Create a new Blog"})}),Object(r.jsx)("div",{className:"col-md-12",children:Object(r.jsx)(v,{})})]})})})})}},eZ7Z:function(e,t,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/crud/blog",function(){return c("MUZa")}])}},[["eZ7Z",1,0,7,5,2,3,4,6,9,8]]]);